#### 下载 axios

```
npm install axios -S
```

#### 封装网络请求

```javascript
import axios from 'axios' //引入 axios

import store from '@/store' //引入 store 文件
```

#### 全局设置

```javascript
//全局设置请求时间(超时)
axios.defaults.timeout = 3000

//全局设置根目录
axios.defaults.baseURL = 'http://127.0.0.1'

//全局设置请求头
axios.defaults.header = {
    'Content-Type': 'application/x-www-form-urlencoded'
}
```

#### create 一个实例

```javascript
const request = axios.create({
    //设置根目录 (基准路径)
    baseURL: 'http://127.0.0.1',

    //设置请求时间(超时)
    timeout: 5000
})
```

#### request (请求拦截)

```javascript
//请求拦截
request.interceptors.request.use(
    config => {
        const { user } = store.state //解构保存在 vuex 中的user对象

        //判断是否登录,同意配置请求头
        if (user && user.token) {
            config.headers.Authorization = `Bearer ${user.token}`
        }

        return config //放行配置信息
    },
    error => {
        return Promise.reject(error) //捕获请求错误信息
    }
)
```

#### response (响应拦截)

```javascript
//响应拦截
request.interceptors.response.use(
    results => {
        //results = results.data
        return results
    },
    error => {
        //响应对应的错误
        Promise.reject(error)

        // err.response.data.errors[Object.keys(err.response.data.errors)[0]][0]
    }
)
```

#### 共享实例

```javascript
export default request
```

#### 使用封装的实例 (封装接口)

```javascript
//引入封装的axios文件
import request from '@/api/...'

export const login = data => {
    //导出封装的请求函数
    return request({
        method: 'POST',
        url: '/api/...',
        data
    })
}
```

#### 使用封装的接口

```javascript
import { login } from './request.js'


methods: {
	async fn() {
		try {
			const res = await login(data)
			console.log(res)
		} catch (err) {
			console.log(err.message)
		}
	}
}
```
